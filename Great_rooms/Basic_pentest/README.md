
![alt_text](https://github.com/Alex-Stinga/TryHackMe/blob/master/Great_rooms/Basic_pentest/images/50-1.png)

This room presented the basic steps which are taken when doing a pentest.

```text
nmap -sV -sC -p- -T 4 -Pn 10.10.206.208
Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-06 03:57 EDT
Nmap scan report for 10.10.206.208
Host is up (0.060s latency).
Not shown: 64791 closed ports, 738 filtered ports
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)
|   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)
|_  256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)
80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Site doesn't have a title (text/html).
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http        Apache Tomcat 9.0.7
|_http-favicon: Apache Tomcat
|_http-title: Apache Tomcat/9.0.7
Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h19m50s, deviation: 2h18m34s, median: -10s
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: basic2
|   NetBIOS computer name: BASIC2\x00
|   Domain name: \x00
|   FQDN: basic2
|_  System time: 2020-08-06T04:16:26-04:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2020-08-06T08:16:26
|_  start_date: N/A
```

I started enumerating on port 80 and found only this message.
![alt_text](https://github.com/Alex-Stinga/TryHackMe/blob/master/Great_rooms/Basic_pentest/images/50-2.png)

Luckily, the page source has this message.  
![alt_text](https://github.com/Alex-Stinga/TryHackMe/blob/master/Great_rooms/Basic_pentest/images/50-3.png)

I don't know where is the dev note, but i can find it by bruteforcing directories.
![alt_text](https://github.com/Alex-Stinga/TryHackMe/blob/master/Great_rooms/Basic_pentest/images/50-4.png)

The only accesible directory found is /development.  
![alt_text](https://github.com/Alex-Stinga/TryHackMe/blob/master/Great_rooms/Basic_pentest/images/50-5.png)

Here is dev.txt  
![alt_text](https://github.com/Alex-Stinga/TryHackMe/blob/master/Great_rooms/Basic_pentest/images/50-6.png)

Here is j.txt  
![alt_text](https://github.com/Alex-Stinga/TryHackMe/blob/master/Great_rooms/Basic_pentest/images/50-7.png)

The nmap scan found smb running and it's worth checking it.
SMB stands for server message block. Itâ€™s a protocol for sharing resources like files, printers, in general any resource which should be retreivable or made available by the server. It primarily runs on port 445 or port 139 depending on the server.
A flaw is using default credentials or easily guessable and sometimes even no authentication for access of important resources of the server.

In this box, everyone has read acces to the Anonymous directory.
![alt_text](https://github.com/Alex-Stinga/TryHackMe/blob/master/Great_rooms/Basic_pentest/images/50-8.png)

The file staff.txt could contain something important.
![alt_text](https://github.com/Alex-Stinga/TryHackMe/blob/master/Great_rooms/Basic_pentest/images/50-9.png)

The message is:
![alt_text](https://github.com/Alex-Stinga/TryHackMe/blob/master/Great_rooms/Basic_pentest/images/50-10.png)

From the messages above it seems there are 2 users Kay and Jan. Usually the ssh username are lowercase, so to bruteforce the password i used the username in lowercase. After a long time, found the password armando for user jan.

The user jan cannot use any sudo command, but Kay does, as he is in the sudo group.
![alt_text](https://github.com/Alex-Stinga/TryHackMe/blob/master/Great_rooms/Basic_pentest/images/50-11.png)
 The home directory of Kay has read and execute privileges on .ssh, and this can be used in the attacker's favor.
![alt_text](https://github.com/Alex-Stinga/TryHackMe/blob/master/Great_rooms/Basic_pentest/images/50-12.png)


The private key is readable by everyone, and made a copy of it and decided to log in as Kay.  
![alt_text](https://github.com/Alex-Stinga/TryHackMe/blob/master/Great_rooms/Basic_pentest/images/50-13.png)

The key is encrypted, but this was not an issue as i extracted the hash using ss2john and cracking it using john.
```bash
 python /usr/share/john/ssh2john.py rsa_key_kay  > id_rsa.hash
```

![alt_text](https://github.com/Alex-Stinga/TryHackMe/blob/master/Great_rooms/Basic_pentest/images/50-14.png)

Very quick it found the password snd i managed to login as kay.
![alt_text](https://github.com/Alex-Stinga/TryHackMe/blob/master/Great_rooms/Basic_pentest/images/50-15.png)

Lastly, here is the password.  
![alt_text](https://github.com/Alex-Stinga/TryHackMe/blob/master/Great_rooms/Basic_pentest/images/50-16.png)










